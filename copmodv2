-- Código principal do Mod Menu
local player = game.Players.LocalPlayer
local screenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))

-- Função para criar frames de categoria
local function createCategory(name, position)
    local categoryFrame = Instance.new("Frame", screenGui)
    categoryFrame.Size = UDim2.new(0, 300, 0, 50)
    categoryFrame.Position = position
    categoryFrame.BackgroundColor3 = Color3.new(0.1, 0.1, 0.1)
    categoryFrame.BorderSizePixel = 0

    local titleLabel = Instance.new("TextLabel", categoryFrame)
    titleLabel.Size = UDim2.new(1, 0, 0, 50)
    titleLabel.Text = name
    titleLabel.TextColor3 = Color3.new(1, 1, 1)
    titleLabel.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
    titleLabel.Font = Enum.Font.SourceSansBold
    titleLabel.TextSize = 24

    -- Botão de minimizar categoria
    local minimizeButton = Instance.new("TextButton", categoryFrame)
    minimizeButton.Size = UDim2.new(0, 50, 0, 50)
    minimizeButton.Position = UDim2.new(1, -50, 0, 0)
    minimizeButton.Text = "_"
    minimizeButton.TextColor3 = Color3.new(1, 1, 1)
    minimizeButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
    minimizeButton.Font = Enum.Font.SourceSansBold
    minimizeButton.TextSize = 20

    local buttonsFrame = Instance.new("Frame", categoryFrame)
    buttonsFrame.Size = UDim2.new(1, 0, 0, 0)
    buttonsFrame.Position = UDim2.new(0, 0, 0, 50)
    buttonsFrame.BackgroundTransparency = 1

    local isMinimized = false
    local function minimizeCategory()
        isMinimized = true
        categoryFrame.Size = UDim2.new(0, 300, 0, 50)
        buttonsFrame.Visible = false
    end

    local function expandCategory()
        isMinimized = false
        local buttonCount = #buttonsFrame:GetChildren() - 1 -- Exclui o frame vazio
        categoryFrame.Size = UDim2.new(0, 300, 0, 50 + (buttonCount * 60))
        buttonsFrame.Visible = true
    end

    minimizeButton.MouseButton1Click:Connect(function()
        if isMinimized then
            expandCategory()
        else
            minimizeCategory()
        end
    end)

    return buttonsFrame
end

-- Função para criar botões dentro de uma categoria
local function createButton(parent, name, activateCallback, deactivateCallback)
    local button = Instance.new("TextButton", parent)
    button.Size = UDim2.new(1, -20, 0, 50)
    button.Position = UDim2.new(0, 10, 0, #parent:GetChildren() * 60 - 60)
    button.Text = name
    button.TextColor3 = Color3.new(1, 1, 1)
    button.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
    button.BorderSizePixel = 0
    button.Font = Enum.Font.SourceSans
    button.TextSize = 20

    local isActive = false

    button.MouseButton1Click:Connect(function()
        isActive = not isActive
        if isActive then
            button.BackgroundColor3 = Color3.new(0, 1, 0) -- Verde quando ativado
            activateCallback() -- Ativar função
        else
            button.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3) -- Cor original quando desativado
            if deactivateCallback then
                deactivateCallback() -- Desativar função
            end
        end
    end)
end

-- Função de voo
local function flyLogic()
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoid = character:WaitForChild("Humanoid")
    local camera = game.Workspace.CurrentCamera
    local primaryPart = character.PrimaryPart

    -- Variável para controlar o voo
    local flying = false

    -- Criar e configurar BodyVelocity e BodyGyro
    local bodyVelocity = Instance.new("BodyVelocity")
    bodyVelocity.MaxForce = Vector3.new(4000, 4000, 4000)
    bodyVelocity.Velocity = Vector3.new()
    bodyVelocity.P = 10000
    bodyVelocity.Parent = primaryPart

    local bodyGyro = Instance.new("BodyGyro")
    bodyGyro.MaxTorque = Vector3.new(4000, 4000, 4000)
    bodyGyro.CFrame = primaryPart.CFrame
    bodyGyro.P = 3000
    bodyGyro.Parent = primaryPart

    -- Função para aplicar movimento
    local function applyMovement()
        bodyVelocity.Velocity = camera.CFrame.LookVector * 100 -- Ajuste a velocidade conforme necessário
        bodyGyro.CFrame = CFrame.new(primaryPart.Position, primaryPart.Position + camera.CFrame.LookVector)
    end

    -- Função para iniciar o voo
    local function startFlying()
        flying = true
        while flying and humanoid:GetState() ~= Enum.HumanoidStateType.Seated do
            applyMovement()
            wait(0.1) -- Ajuste o intervalo conforme necessário
        end
    end

    -- Função para parar o voo
    local function stopFlying()
        flying = false
        bodyVelocity.Velocity = Vector3.new() -- Parar movimento
        bodyGyro.CFrame = primaryPart.CFrame -- Resetar rotação
    end

    return startFlying, stopFlying
end

-- Função para teleporte ao clicar
local function teleportOnClick()
    local mouse = player:GetMouse()

    -- Função que teleporta o jogador para a posição clicada
    local function teleportTo(position)
        local character = player.Character or player.CharacterAdded:Wait()
        local primaryPart = character.PrimaryPart

        primaryPart.CFrame = CFrame.new(position) + Vector3.new(0, 3, 0) -- Teleporta o personagem 3 unidades acima para evitar colisão com o chão
    end

    -- Espera por clique do mouse
    mouse.Button1Down:Connect(function()
        local targetPosition = mouse.Hit.p -- Obtém a posição 3D do ponto clicado
        teleportTo(targetPosition)
    end)
end

-- Criar categorias de botões
local flightCategory = createCategory("Flight Controls", UDim2.new(0.5, -150, 0.5, -200))
local teleportCategory = createCategory("Teleport Controls", UDim2.new(0.5, -150, 0.5, -100))
local miscCategory = createCategory("Misc Controls", UDim2.new(0.5, -150, 0.5, 0))

-- Adicionar botões na categoria de voo
local startFly, stopFly = flyLogic()
createButton(flightCategory, "Fly", startFly, stopFly)

-- Adicionar botões na categoria de teleporte
createButton(teleportCategory, "Teleport", teleportOnClick)

-- Adicionar outros botões na categoria de controles diversos
createButton(miscCategory, "Speed Boost", function()
    -- Lógica para aumentar a velocidade
end, function()
    -- Lógica para desativar o aumento de velocidade
end)

createButton(miscCategory, "Invincible", function()
    -- Lógica para invencibilidade
end, function()
    -- Lógica para desativar a invencibilidade
end)

createButton(miscCategory, "High Jump", function()
    -- Lógica para pulo alto
end, function()
    -- Lógica para desativar o pulo alto
end)

createButton(miscCategory, "Reset", function()
    -- Lógica para resetar status
end, function()
    -- Lógica para desativar o reset
end)
